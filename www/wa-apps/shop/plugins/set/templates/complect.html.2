<div id="shop-set-plugin-complect-block" class="shop-set-plugin-complect-block-mobile">
    <div class="main-category-block ">
        <div class="main-category-title"><i class="fa fa-list"></i>Комплекты к товару: </div>
    </div>	
    <span class="jssora11l"></span>
    <span class="jssora11r"></span>    
    <div class="swipe" id="mySwipe">
	{foreach $product_sets as $sku_id=>$p}
	<div class="sku-sets wrap swipe-wrap" id="sku-sets-{$sku_id}">
		{if count($p.sets) > 0}
		{foreach $p.sets as $set}        
		{if count($set.items) > 0 && $set.available}

    		<div class="set" id="set-{$set.id}">
    			<div class="set-base-product">
    				<div class="set-image">
    				{if !empty($p.image)}
    				{$wa->shop->productImgHtml($p.image, '80', ['itemprop' => 'image', 'alt' => $p.name])}
    				{/if}
    				</div>
    				<div class="set-product-name">
    					<a href="{$p.url}">{$p.name}</a><br>
						<div class="set-product-price"><b>{shop_currency($p.sku_price,$p.currency)}</b></div>
    				</div>
    				
    			</div>
    			{foreach $set.items as $item}
    			<div class="set-item-plus">+</div>
    			<div class="set-item">
    				<div class="set-image">
    				{if !empty($item.image)}
    				{$wa->shop->productImgHtml($item.image, '80', ['itemprop' => 'image', 'alt' => $item.name])}
    				{/if}
    				</div>
    				<div class="set-item-name">
    					<a href="{$item.url}">{$item.name}</a>
						<br>
						<div class="set-item-price">
							<b>{shop_currency($item.price,$item.currency)}</b>
							{if $item.sku_price != $item.price}
							<br>
							<s>{shop_currency($item.sku_price,$item.currency)}</s>
							{/if}
						</div>
    				</div>
    			
    				{$d = round(100*($item.sku_price - $item.price)/$item.sku_price)}
    				{if $d}<div class="set-item-discount">-{$d}%</div>{/if}
    				{if $item.count > 1}<div class="set-item-count">{$item.count} шт.</div>{/if}
    			</div>
    			{/foreach}
    			<div class="set-item-plus">=</div>
    			<div class="set-result">
    				<div class="set-total-price">{shop_currency($set.total)}</div>
    				<button data-sku-id="{$sku_id}" data-set-id="{$set.id}"{if !$set.available} style="display:none;"{/if}>Купить комплект</button>
    				<div class="set-error"{if $set.available} style="display:none"{/if}>нет в наличии</div>
    				<div class="set-success" style="display:none">добавлен в корзину</div>
    			</div>
    		</div>

		{/if}
		{/foreach}
		{/if}
	</div>
	{/foreach}    
    </div>
</div>

<div id="shop-set-plugin-complect-block" class="shop-set-plugin-complect-block-desktop">
    <div class="main-category-block ">
        <div class="main-category-title"><i class="fa fa-list"></i>Комплекты к товару: </div>
    </div>	
	{foreach $product_sets as $sku_id=>$p}
	<div class="sku-sets" id="sku-sets-{$sku_id}">
		{if count($p.sets) > 0}
		{foreach $p.sets as $set}        
		{if count($set.items) > 0 && $set.available}

    		<div class="set" id="set-{$set.id}">
    			<div class="set-base-product">
    				<div class="set-image">
    				{if !empty($p.image)}
    				{$wa->shop->productImgHtml($p.image, '80', ['itemprop' => 'image', 'alt' => $p.name])}
    				{/if}
    				</div>
    				<div class="set-product-name">
    					<a href="{$p.url}">{$p.name}</a>
    				</div>
    				<div class="set-product-price"><b>{shop_currency($p.sku_price,$p.currency)}</b></div>
    			</div>
    			{foreach $set.items as $item}
    			<div class="set-item-plus">+</div>
    			<div class="set-item">
    				<div class="set-image">
    				{if !empty($item.image)}
    				{$wa->shop->productImgHtml($item.image, '80', ['itemprop' => 'image', 'alt' => $item.name])}
    				{/if}
    				</div>
    				<div class="set-item-name">
    					<a href="{$item.url}">{$item.name}</a>
    				</div>
    				<div class="set-item-price">
    					<b>{shop_currency($item.price,$item.currency)}</b>
    					{if $item.sku_price != $item.price}
    					<br>
    					<s>{shop_currency($item.sku_price,$item.currency)}</s>
    					{/if}
    				</div>
    				{$d = round(100*($item.sku_price - $item.price)/$item.sku_price)}
    				{if $d}<div class="set-item-discount">-{$d}%</div>{/if}
    				{if $item.count > 1}<div class="set-item-count">{$item.count} шт.</div>{/if}
    			</div>
    			{/foreach}
    			<div class="set-item-plus">=</div>
    			<div class="set-result">
    				<div class="set-total-price">{shop_currency($set.total)}</div>
    				<button data-sku-id="{$sku_id}" data-set-id="{$set.id}"{if !$set.available} style="display:none;"{/if}>Купить комплект</button>
    				<div class="set-error"{if $set.available} style="display:none"{/if}>нет в наличии</div>
    				<div class="set-success" style="display:none">добавлен в корзину</div>
    			</div>
    		</div>

		{/if}
		{/foreach}
		{/if}
	</div>
	{/foreach}        
</div>

<script type="text/javascript" src="/wa-data/public/shop/themes/fenix/js/swipe.js"></script>
{literal}
<script type="text/javascript">
var mySwipe = $('#mySwipe').Swipe({auto: 4000, continuous: true}).data('Swipe');
if ( mySwipe.getNumSlides() < 2 ) {
    $(".jssora11r").hide();
    $(".jssora11l").hide();
} else {
    $(".jssora11l").click( function() {
    	mySwipe.prev();
    });

    $(".jssora11r").click( function() {
    	mySwipe.next();
    })
}
$( window ).resize( function () {
    if ( ($(window).width()) < 1200) {
        //mySwipe.slide(0);
        $(".shop-set-plugin-complect-block-mobile").show();
        $(".shop-set-plugin-complect-block-desktop").hide();
        
    } else {
        $(".shop-set-plugin-complect-block-mobile").hide();
        $(".shop-set-plugin-complect-block-desktop").show();        
    }
});

$( window ).resize();
</script>
{/literal}

