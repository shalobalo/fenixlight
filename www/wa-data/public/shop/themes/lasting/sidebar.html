<aside class="col-md-3">
{if $categories = $wa->shop->categories()}
    <div class="main-category-block ">
        <div class="main-category-title"><i class="fa fa-list"></i> Категории</div>
    </div>
    <div class="widget-block">
        <ul class="list-unstyled ul-side-category">
            {foreach $categories as $c}
                {if $c.parent_id == 0}
                    <li><a href="{$c.url}"{if isset($category) && $category.id == $c.id }class="active"{/if}>{if $c.include_sub_categories}<i class="fa fa-angle-right"></i>{/if} {$c.name|escape}</a>
                    {if $c.include_sub_categories}
                        <ul class="sub-category"{if isset($category) && ( $category.id == $c.id || $category.parent_id == $c.id || $categories[$category.parent_id].parent_id == $c.id ) } style="display: block;"{/if}>
                        {foreach $categories as $sub_c}
                            {if $sub_c.parent_id == $c.id}
                                <li><a href="{$sub_c.url}"{if isset($category) && $category.id == $sub_c.id }class="active"{/if}>{if $sub_c.include_sub_categories}<i class="fa fa-angle-right"></i>{/if} {$sub_c.name|escape}</a>
                                {if $sub_c.include_sub_categories}
                                    <ul class="sub-category"{if isset($category) && ($category.id == $sub_c.id || $category.parent_id == $sub_c.id ) } style="display: block;"{/if}>
                                    {foreach $categories as $sub_sub_c}
                                        {if $sub_sub_c.parent_id == $sub_c.id}<li><a href="{$sub_sub_c.url}"{if isset($category) && $category.id == $sub_sub_c.id }class="active"{/if}> {$sub_sub_c.name|escape}</a></li>{/if}
                                    {/foreach}
                                    </ul>
                                {/if}
                                </li>
                            {/if}
                        {/foreach}
                        </ul>
                    {/if}
                    </li>
                {/if}
            {/foreach}
        </ul>
    </div>
{/if}

{if !empty($filters)}
    {foreach $filters as $fid => $filter}
        {if $fid == 'price'}
            {$c = $wa->shop->currency(true)}
            <div class="widget-title"><i class="fa fa-money"></i> Цена</div>
            <div class="widget-block">
                <div class="row">
                    <div class="col-md-6">
                        <div class="input-group">
                            <span class="input-group-addon">{$c.sign}</span>
                            <input name="price_min" type="text" id="price_min" class="form-control" {if $wa->get('price_min')}value="{(int)$wa->get('price_min')}"{/if}>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="input-group">
                            <span class="input-group-addon">{$c.sign}</span>
                            <input name="price_max" type="text" id="price_max" class="form-control" {if $wa->get('price_max')}value="{(int)$wa->get('price_max')}"{/if}>
                        </div>
                    </div>
                </div>
            </div>
        {else}
            <div class="widget-title"><i class="fa fa-filter"></i> {$filter.name}</div>
            <div class="widget-block filter">
                <ul class="clearfix list-unstyled">
                    {foreach $filter.values as $v_id => $v}
                    <li class="checkbox"><label><input type="checkbox" name="{$filter.code}[]" id="{$filter.code}_{$v_id}" {if in_array($v_id, $wa->get($filter.code, array()))}checked{/if} value="{$v_id}"> {$v}</label></li>
                    {/foreach}
                </ul>
            </div>
        {/if}
    {/foreach}
    {literal}
    <script language="javascript">
        var url='{/literal}/category/{$cat_url}/{literal}';
        var cc=0;
    </script>
    {/literal}

    <input type="submit" value="[`Filter products`]" style="float:left;width:100%;margin:20px 0px;" onclick="
            {foreach $filters as $fid => $filter}
                {if $fid == 'price'}
                    if(document.getElementById('price_min').value!='')
                        {literal}{url=url+'price_min-'+document.getElementById('price_min').value+'/';}{/literal}
                    if(document.getElementById('price_max').value!='')
                        {literal}{url=url+'price_max-'+document.getElementById('price_max').value+'/';}{/literal}
                {else}
                    {foreach $filter.values as $v_id => $v}
                        if(document.getElementById('{$filter.code}_{$v_id}').checked==true )
                         {literal}{ {/literal}
                            if(cc==0) {literal}{ {/literal} url=url+'ff-'; {literal}} {/literal} else  {literal}{ {/literal} url=url+'-'; {literal}} {/literal}
                            cc=cc+1;
                            url=url+'{$filter.code}_{$v_id}';
                         {literal}} {/literal}
                    {/foreach}
                {/if}
            {/foreach}
             window.location=url;
            ">
{/if}
</aside>